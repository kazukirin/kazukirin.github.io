---
layout: post
title:  "さたにあ式マイクでAudioLinkを使ってみた"
date:   2025-04-20 00:00:00 +0900
categories: [Unity,VRChat]
tags: [Unity,VRChat,ワールド作成,ギミック]
---

## はじめに
今後、VRChat内のイベント用により臨場感のあるライブ会場を作りたいと思ったので調べてみました。

自分自身の備忘録のために記事にまとめていますが、誰かの助けになれれば嬉しいです。

## やりたいこと
「さたにあ式マイク」を使用しているプレイヤーの音声に合わせて、エフェクトやパーティクルを操作する。

## 動作環境
- Unity 2022.3.22f1
- VRChat SDK - Worlds   3.8.0
- VRChat SDK - Base     3.8.0
- Audio Link            2.1.0
- lilToon               1.9.0


## どうやってワールド全体に自分の声を届けているのか
音声自体は非同期で送受信しており、生データを直接加工することはできません。

「VRC.SDKBase」という名前空間で提供されるプレイヤー情報や操作を行うためのクラス「VRCPlayerApi」を利用して音声ストリームの制御を行っています。

プレイヤー１人１人の音声制御情報(DataDictionary型)をクライアント側で管理しているので、人によって管理の状態が異なります。

大きく分けて以下の3ステップで音声制御情報を管理しています。

1. ワールドにJoinしているプレイヤーのPlayerIDを取得
2. プレイヤー１人１人のマイクからの音声制御情報をPlayerIdとの組で管理
3. マイクを使用している人の音声制御情報だけを書き換え、音の届く範囲を調整

したがって、マイクを使用しているプレイヤーの音声に合わせてエフェクトやパーティクルを操作するには、
マイクを使用しているプレイヤーの「PlayerId」と「音声制御情報」が必要になりそう...？

##


### さたにあ式のマイクについて
ワールド全体に自分の声を届けるマイクギミックです。

3Dモデルも用意されており、Prefabをそのままワールドに設置するだけで高品質のマイクを使えます。

また、Reverbギミック込みバージョンも販売されています。

[boothリンク]

### AudioLinkについて
Unity上でリアルタイムにオーディオ信号を解析し、そのスペクトラムや波形データをシェーダーに渡してビジュアライズするためのオープンソースプラグインです。

[GitHubリンク]

[boothリンク]: https://saturnianshop.booth.pm/items/5284461
[GitHubリンク]: https://github.com/llealloo/audiolink